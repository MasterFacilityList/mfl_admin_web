<div class="col-xs-12 content-card">
    <div class="col-md-12 alert alert-danger alert-dismissible margin-t-20" ng-show="geoloc_error || wards_error || geocodes_error">
        <button type="button" class="close">
            <span ng-click="geoloc_error = !geoloc_error">&times;</span>
        </button>
        <p ng-if="geoloc_error" class="fs-18"><i class="fa fa-times-circle"></i> &nbsp; {{geoloc_error}}</p>
        <p ng-if="wards_error" class="fs-18"><i class="fa fa-times-circle"></i> &nbsp; {{wards_error}}</p>
        <p ng-if="geocodes_error" class="fs-18"><i class="fa fa-times-circle"></i> &nbsp; {{geocodes_error}}</p>
    </div>
    <div class="col-sm-12 margin-t-20">
        <div class="col-xs-12">
            <h4 class="fw-600 fs-18"> Geolocation Details</h4>
        </div>
    </div>
    <form name="geoForm">
        <div class="margin-t-50">
               <div ng-if="spinner1">
                   <i class="fa fa-spin fa-circle-o-notch fa-5x"></i>
               </div>
               <div ng-if="!spinner1">
                    <form name="geoForm">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="col-sm-12">
                                    <!-- Start of form -->
                                    <div class="form-group col-md-12">
                                        <label>Geocode source</label>
                                        <ui-select name="source" ng-model="select_values.source" required>
                                            <ui-select-match placeholder="Select a geo code source...">
                                                <span>{{$select.selected.name}}</span>
                                            </ui-select-match>
                                            <ui-select-choices repeat="gcm.id as gcm in geo_sources | filter:$select.search">
                                                <span>{{gcm.name}}</span>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group col-md-12">
                                        <label>Geocode method</label>
                                        <ui-select name="method" ng-model="select_values.method" required>
                                            <ui-select-match placeholder="Select a geo code method...">
                                                <span>{{$select.selected.name}}</span>
                                            </ui-select-match>
                                            <ui-select-choices repeat="gcm.id as gcm in geo_methods | filter:$select.search">
                                                <span>{{gcm.name}}</span>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group col-md-12">
                                        <label for="collection date">
                                            <span class="fs-16">Collection date:</span>
                                                <strong>{{geo.collection_date | date}}</strong>
                                        </label>
                                    </div>
                                <!-- End of first section of form -->
                                <!-- Start lat long -->
                                            <div class="form-group col-sm-6">
                                                <label>
                                                    Longitude
                                                </label>
                                                <input type="number" class="form-control" step="0.00000001" name="longitude" ng-model="geo.coordinates.coordinates[0]"
                                                ng-keypress="checkLocation()" ng-model-options="{ debounce: 250 }"/>
                                                <span class="highlight"></span>
                                                <span class="bar"></span>
                                            </div>
                                            <div class="form-group col-sm-6">
                                                <label>
                                                    Latitude
                                                </label>
                                                <input type="number" class="form-control" step="0.00000001" name="latitude" ng-model="geo.coordinates.coordinates[1]"
                                                ng-keypress="checkLocation()" ng-model-options="{ debounce: 250 }"/>
                                                <span class="highlight"></span>
                                                <span class="bar"></span>
                                            </div>
                                  <!-- End lat long -->
                                <div class="col-md-12 margin-t-10 margin-b-20">
                                   <div>
                                    <h4>{{ward_gis.properties.name | titlecase}} Ward</h4>
                                   </div>
                                    <leaflet id="wardmap"
                                        defaults="defaults"
                                        markers="markers"
                                        events="events"
                                        layers="layers"
                                        tiles="tiles"
                                        width="100%"
                                        height="300px"
                                        geojson="geojson">
                                     </leaflet>
                                </div>
                                </div>

                            </div>
                        </div>
                    </form>
               </div>
        </div>
    </form>
    <div class="col-xs-12">
        <a ui-sref="facilities.facility_edit.basic" ng-if="!create" class="mfl-btn mfl-btn-primary margin-t-20 margin-b-10 margin-l-10">
            &nbsp;<i class="fa fa-angle-double-left"></i> Basic Details
        </a>
        <a ui-sref="facilities.facility_create.basic({facility_id : new_facility})" ng-if="create" class="mfl-btn mfl-btn-primary margin-t-20 margin-b-10">
            &nbsp;<i class="fa fa-angle-double-left"></i> Basic Details
        </a>
        <button type="submit" ng-click="saveGeo(geoForm)"  requires-permission="facilities.change_facility,mfl_gis.add_facilitycoordinates" class="mfl-btn mfl-btn-primary margin-t-20 margin-b-10 pull-right margin-r-10" >
            &nbsp;{{create ? 'Facility Contacts' : 'Save & Continue'}} <i class="fa fa-angle-double-right"></i>
        </button>
    </div>
</div>

